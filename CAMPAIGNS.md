# Utempo Campaigns

Дата: 22 сентября 2025 года

# Таблицы

| № | Таблица | Описание | Поля | Методы доступа API |
| :---- | :---- | :---- | :---- | :---- |
| 1 | Campaigns (Рекламные Кампании) | Центральная сущность нового модуля. Хранит каждую кампанию, созданную с помощью ИИ, на этапе планирования и моделирования. Аналог сущности "Рекламная кампания" из схемы данных MVP. | ai\_campaign\_id: int PKowner\_id: FK Users,name: Stringdescription: Text`objective`: Text (Цель кампании).`campaign_category`: Enum (например, 'branding', 'performance', 'retention').status: Enum \['draft', 'processing', 'review', 'approved', 'rejected'\]version: String, default: 'v1'parent\_ai\_campaign\_id: FK, self-referencinglinked\_activity\_id: FK, Activities, nullable`kpi_targets`: JSON. Для хранения структурированных KPI, извлеченных из брифа (например, `[{ type: 'leads', target: 1200 }, { type: 'ROI', target: 1.5 }]`)`budget_limit`: JSON (например, `{ online: 8000000, offline: 1500000 }`).created\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | getCampaign(id: int) \-\> CampaignПолучает одну кампанию ИИ по ID.createCampaign(data: {name: String, description: String}) \-\> CampaignСоздает новую кампанию ИИ (инициация процесса).updateCampaignStatus(id: int, status: String) \-\> CampaignОбновляет статус кампании (например, после утверждения медиаплана).createCampaignVersion(id: int) \-\> CampaignСоздает новую версию кампании для A/B тестирования или флайтов, ссылаясь на родительскую.promoteToActivity(id: int, activityTypeId: Int, parentActivityId: Int) \-\> ActivityКлючевой метод интеграции. Создает новую запись в таблице Activities на основе утвержденной Campaign и связывает их через linked\_activity\_id. |
| 2 | CampaignDocuments (Документы кампании) | Хранит исходные файлы (стратегии, брифы), которые анализирует LLM для извлечения параметров. | document\_id: int PKai\_campaign\_id: FK, Campaignsfile\_name: Stringfile\_type: Stringfile\_path: Stringextracted\_text: Textprocessing\_status: Enum \['uploaded', 'processing', 'processed', 'error'\]extracted\_params\_json: JSONconfidence\_level: Floatuploaded\_at: Timestampcreated\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | uploadDocument(aiCampaignId: int, file: File) \-\> CampaignDocumentЗагружает файл, связывает его с кампанией и запускает процесс извлечения текста.processDocumentWithLlm(documentId: int) \-\> JobStatusАсинхронно отправляет извлеченный текст в LLM для анализа и сохранения extracted\_params\_json. |
| 3 | CampaignParams (Параметры кампании) | Хранит структурированные параметры, извлеченные или рассчитанные ИИ (ЦА, бюджет, KPI и т.д.). Основано на сущности "Параметр рекламной кампании" и результатах Промпта 2\. | param\_id: int PKai\_campaign\_id: FK, Campaignsparam\_name: Stringparam\_value: Textparam\_type: Enum \['ЦА', 'география', 'каналы', 'форматы', 'стратегия', 'KPI', 'ограничение', 'период'\]source: Enum \['document', 'calculated', 'manual'\]confidence\_level: Enum \['высокий', 'средний', 'низкий', 'предположено'\]comment: Stringversion: String, default: 'v1'created\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | getCampaignParams(aiCampaignId: int) \-\> List\[CampaignParam\]Получает все параметры для кампании.updateCampaignParam(id: int, data: {param\_value: String, comment: String}) \-\> CampaignParamПозволяет пользователю вручную редактировать параметры, предложенные ИИ.generateParamsFromDocument(documentId: int) \-\> List\[CampaignParam\]Запускает LLM для генерации "карточки рекламной кампании" и таблицы параметров. |
| 4 | ChecklistItems (Чек-лист кампании) | Отслеживает полноту данных, необходимых для построения медиамикса, как описано в Шаге 5\. | checklist\_item\_id: int PKai\_campaign\_id: FK, Campaignsitem\_name: Stringstatus: Enum \['Да', 'Нет', 'Частично'\]comment: Stringcreated\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | validateCampaignData(aiCampaignId: int) \-\> List\[ChecklistItem\]Проверяет наличие всех необходимых параметров и обновляет статусы в чек-листе. |
| 5 | MediaMixVariants (Варианты медиамикса) | Хранит различные версии медиамикса (например, черновик, оптимизированный, ручной), сгенерированные ИИ. | mix\_variant\_id: int PKai\_campaign\_id: FK, Campaignsname: Stringdescription: Textstatus: Enum \['draft', 'active', 'archived'\]`start_date`, `end_date`: Date.`frequency`: String.total\_budget: Decimaltotal\_reach: Integersource: Enum \['generated\_llm', 'optimized\_llm', 'manual'\]created\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | generateInitialMediaMix(aiCampaignId: int) \-\> MediaMixVariantИспользует LLM и исторические данные для создания чернового медиамикса.optimizeMediaMix(mixVariantId: int, goal: String) \-\> MediaMixVariantЗапускает LLM для оптимизации существующего микса под конкретную цель (ROI, охват).getMediaMixVariants(aiCampaignId: int) \-\> List\[MediaMixVariant\]Получает все варианты медиамиксов для кампании. |
| 6 | MediaMixItems (Строки медиамикса) | Детализация каждого варианта медиамикса по каналам. Структура полей основана на выводе медиамикса. | mix\_item\_id: int PKmix\_variant\_id: FK, MediaMixVariantschannel\_name: Stringaudience\_segment: Stringad\_format: Stringbudget: Decimalreach: Integercpm: Decimalkpi1\_type: Stringkpi1\_value: Stringkpi2\_type: Stringkpi2\_value: Stringcomment: Stringcreated\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | getMediaMixItems(mixVariantId: int) \-\> List\[MediaMixItem\]Получает все строки для конкретного варианта медиамикса.updateMediaMixItem(id: int, data: {...}) \-\> MediaMixItemПозволяет пользователю вручную редактировать бюджеты, KPI и другие детали строки микса. |
| 7 | MediaPlanVariants (Варианты медиаплана) | Хранит утвержденный сценарий размещения, готовый к переносу в Activities. | plan\_variant\_id: int PKai\_campaign\_id: FK, Campaignsbased\_on\_mix\_id: FK, MediaMixVariantsname: Stringstatus: Enum \['draft', 'approved'\]total\_budget: Decimalstart\_date: Date, end\_date: Datecreated\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | generateMediaPlan(mixVariantId: int) \-\> MediaPlanVariantПреобразует утвержденный медиамикс в детальный медиаплан с временными рамками.exportMediaPlan(planVariantId: int, format: String) \-\> FileФормирует выгрузку медиаплана в XLSX или PDF для согласования. |
| 8 | MediaPlanItems (Строки медиаплана) | Конкретные тактики/размещения внутри медиаплана, которые станут дочерними Activities. Структура полей основана на итоговом медиаплане. | plan\_item\_id: int PKplan\_variant\_id: FK, MediaPlanVariantsname: Stringchannel\_name: Stringlocation:String,ad\_format: Stringstart\_date, end\_date: Datecost: Decimalplacements\_count: Integervendor: Stringkpi\_type: Stringkpi\_value: Stringcreated\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | getMediaPlanItems(planVariantId: int) \-\> List\[MediaPlanItem\]Получает все строки медиаплана.promoteToActivities(planVariantId: int)Ключевой метод интеграции. Для каждой строки MediaPlanItems создает дочернюю Activity (типа "Тактика") внутри родительской Activity, созданной из Campaign. |
| 9 | KnowledgeBaseChannels (Исторические данные по каналам) | Хранит исторические данные об эффективности каналов, которые LLM использует для генерации и оптимизации медиамиксов. Аналог сущности "Исторические данные". | kb\_channel\_id:int PKchannel\_name: Stringad\_format: Stringaudience\_segment: Stringperiod: Stringkpi\_type: Stringkpi\_value: Decimalsource: Stringreliability: Enum \['высокий', 'средний', 'низкий'\]created\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | addHistoricalData(data: List\[...\]) \-\> SuccessStatusДобавляет или обновляет исторические данные по эффективности каналов.getChannelPerformance(channel: String, audience: String) \-\> PerformanceDataВнутренний метод для LLM, чтобы получать бенчмарки при построении медиамикса. |
| 10 | Prompts | Промпты ИИ | `prompt_id: int` (PK), `name:` String, `role_description` (Text), `instruction_text` (Text), `output_format` (String).created\_by: string (FK Users)updated\_by: string (FK Users)created\_at: datetimeupdated\_at: datetime | `getPrompts()`, `updatePrompt(id, data)`. |

# Экраны

| № | Экран | Описание | Области/Режимы | Элементы | Вызываемые экраны | Методы | Сценарии |
| :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- |
| 1 | Campaigns List (Список кампаний ИИ) | Главный экран модуля. Отображает список всех кампаний, созданных с помощью ИИ, их текущий статус и основные метаданные. Позволяет пользователю инициировать создание новой кампании. | — Список кампаний (таблица)— Панель инструментов | — Таблица со столбцами: Название, Статус, Версия, Ответственный, Дата создания.— Кнопка \+ Создать кампанию.— Фильтры по статусу, дате, владельцу.— Поиск по названию. | Campaign Workspace | getCampaigns(filters)createCampaign(data) | Пользователь заходит в модуль Campaigns и видит список всех своих кампаний. Он нажимает \+ Создать кампанию, чтобы запустить процесс для нового брифа. Найдя существующую кампанию в статусе "Черновик", он кликает по ней, чтобы продолжить работу, переходя на экран Campaign Workspace. |
| 2 | Campaign Workspace (Рабочее пространство кампании) | Центральный экран для работы с одной конкретной кампанией ИИ. Он ведет пользователя по всему процессу от загрузки документов до формирования итогового медиаплана. Экран разделен на логические шаги (этапы). | — Шаг 1: Документы и Параметры— Шаг 2: Чек-лист— Шаг 3: Моделирование медиамикса— Шаг 4: Формирование медиаплана— Панель инструментов | — Панель инструментов: Название кампании, статус, кнопка Создать версию, кнопка Утвердить и перенести в Activities.— Навигация по шагам: Вкладки или шаги, соответствующие областям. Два представления данных, которые генерирует ИИ: **"Карточка рекламной кампании"** и **"Таблица параметров"**. Это может быть реализовано как две подвкладки или два блока на экране. Карточка дает общее саммари, а таблица — детали для медиамикса. | File Upload DialogParameters EditorMedia Mix EditorMedia Plan Editor | getCampaign(id)updateCampaignStatus(id, status)promoteToActivity(id, ...)createCampaignVersion(id) | Пользователь открывает кампанию и последовательно проходит по шагам:• Шаг 1: Загружает файлы брифов и стратегий, система автоматически анализирует их и формирует карточку и таблицу параметров кампании. Пользователь просматривает и при необходимости корректирует извлеченные ИИ данные.• Шаг 2: Переходит на вкладку с чек-листом, чтобы убедиться, что данных достаточно для дальнейшей работы.• Шаг 3: Запускает генерацию чернового медиамикса, а затем его оптимизацию.• Шаг 4: На основе утвержденного микса генерирует медиаплан и экспортирует его для согласования.• Завершение: После всех согласований нажимает Утвердить и перенести в Activities, чтобы создать соответствующие записи в основном модуле планирования. |
| 3 | Knowledge Base (База знаний ИИ) | Раздел для администраторов и аналитиков. Позволяет управлять историческими данными об эффективности каналов и правилами (промптами), которые ИИ использует для генерации и оптимизации планов. | — Исторические данные по каналам— Управление промптами | — Таблица с историческими данными по каналам (Канал, Формат, ЦА, Период, KPI, Значение).— Кнопки для импорта/экспорта исторических данных.**\- "Список промптов"** с возможностью выбора (например, "Промпт 1", "Промпт 4", "Промпт 5" и т.д.)— Редакторы текста для каждого промпта (например, Промпт 1, Промпт 2 и т.д.).  | — | getKnowledgeBaseChannels()addHistoricalData(data)getPrompts()updatePrompt(id, text) | Аналитик: Периодически загружает свежие данные об эффективности рекламных каналов, пополняя базу знаний для ИИ.Администратор: Заходит в раздел управления промптами, чтобы донастроить инструкции для LLM. Например, он редактирует "Промпт 2: Формирование таблицы параметров", добавляя новый обязательный для извлечения параметр, чтобы повысить качество генерируемых данных. |
| 4 | File Upload Dialog (Окно загрузки документов) | Модальное окно для загрузки исходных документов (брифов, стратегий), которые ИИ будет анализировать. | — Область Drag-and-drop— Индикатор загрузки | — Кнопка Выбрать файлы.— Список загружаемых файлов с индикаторами прогресса.— Кнопка Запустить анализ. | — | uploadDocument(campaignId, file)processDocumentWithLlm(documentId) | Находясь на экране Campaign Workspace, пользователь нажимает кнопку "Загрузить документ". В появившемся окне он перетаскивает PDF-файл с брифом кампании. После загрузки файла он нажимает "Запустить анализ", и система в фоновом режиме начинает извлечение текста и параметров. |
| 5 | Parameters Editor (Редактор параметров) | Область на экране Campaign Workspace, где отображается "Карточка рекламной кампании" и таблица извлеченных параметров. Позволяет пользователю редактировать значения, предложенные ИИ, и добавлять комментарии. | — Режим "Карточка"— Режим "Таблица" | — Интерактивная таблица с полями Параметр, Значение, Источник, Уровень уверенности, Комментарий.— Редактируемые поля Значение и Комментарий.— Визуальные индикаторы уровня уверенности (цветом или иконками). | — | getCampaignParams(campaignId)updateCampaignParam(id, data) | После анализа документов ИИ заполнил таблицу параметров. Пользователь видит, что для параметра "Частота контакта" уровень уверенности "низкий", а значение "предположено". Он вручную вводит в это поле корректное значение "3-5 в неделю" и добавляет комментарий "Согласовано с клиентом". |
| 6 | Media Mix Editor (Редактор медиамикса) | Интерактивная таблица для просмотра и редактирования вариантов медиамикса. Позволяет сравнивать черновой и оптимизированный миксы, а также вручную корректировать бюджеты по каналам. | — Режим сравнения вариантов— Режим редактирования | — Переключатель вариантов микса (например, "Черновой", "Оптимизированный").— Таблица медиамикса с редактируемыми полями Бюджет, KPI и др.— Итоговые суммы по бюджету и охвату.— Кнопки Оптимизировать микс, Сохранить как новый вариант. `Кнопка Добавить строку` (для ручного добавления канала).         ▪ Иконка `удаления` для каждой строки микса.  | Optimization Goal Dialog | getMediaMixVariants(campaignId)updateMediaMixItem(id, data) | Пользователь сгенерировал черновой микс и теперь хочет его улучшить. Он нажимает кнопку Оптимизировать микс и в появившемся окне выбирает цель "Максимизация ROI". ИИ перераспределяет бюджеты и исключает неэффективный канал (VK). Пользователь вручную немного увеличивает бюджет на Instagram, и система пересчитывает итоговые показатели. |
| 7 | Media Plan Editor (Редактор медиаплана) | Интерактивная таблица для просмотра и редактирования финального медиаплана. Позволяет задавать конкретные даты размещений, подрядчиков и другие детали, необходимые для исполнения. | — Режим редактирования— Режим просмотра | — Таблица медиаплана с полями Канал, Формат, Период размещения, Стоимость, Подрядчик и т.д..— Календарь для выбора дат.— Кнопка Экспорт в XLSX/PDF. | — | getMediaPlanItems(planVariantId)exportMediaPlan(planVariantId, format) | На основе утвержденного медиамикса система сгенерировала проект медиаплана. Пользователь открывает его и для каждой строки указывает точные даты начала и окончания размещений. В поле "Подрядчик" он выбирает нужные агентства из справочника. После завершения он нажимает Экспорт в XLSX, чтобы получить готовый документ для отправки на утверждение. |
| 8 | Optimization Goal Dialog (Окно выбора цели оптимизации) | Всплывающее окно, которое появляется при запуске оптимизации медиамикса. Позволяет пользователю выбрать, по какому критерию ИИ должен перераспределить бюджет. | — | — Список целей для оптимизации (например, "Максимизировать ROI", "Максимизировать охват", "Снизить CPM").— Кнопка Запустить оптимизацию. | — | optimizeMediaMix(mixVariantId, goal) | Пользователь нажимает Оптимизировать микс. В появившемся окне он видит несколько вариантов. Он выбирает "Максимизировать охват" и нажимает Запустить оптимизацию. Система передает эту цель в LLM, который генерирует новый вариант медиамикса с перераспределенным бюджетом. |
| 9 | CampaignDashboard  | **Дашборд кампании \- Сводный экран, который после переноса кампании в `Activities` показывает сравнение плановых показателей (из `MediaPlanItems`) с фактическими данными, подтягиваемыми из основной MRM-системы.** |  | Виджеты с KPI (план/факт), график освоения бюджета, статус дочерних `Activities` |  |  | Маркетолог заходит на дашборд утвержденной кампании "Живи на своём", чтобы отследить, как фактические затраты и KPI по лидам соотносятся с тем, что было смоделировано ИИ. |

